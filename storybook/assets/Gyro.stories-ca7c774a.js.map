{"version":3,"file":"Gyro.stories-ca7c774a.js","sources":["../../node_modules/d3-array/src/range.js","../../src/elements/base/gyro.ts"],"sourcesContent":["export default function range(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n}\n","/* eslint-disable no-underscore-dangle */\nimport { html, svg, css, LitElement, TemplateResult } from 'lit';\nimport { property, query } from 'lit/decorators.js';\n// TODO: We should only import the parts we need\nimport * as d3 from 'd3';\n\nfunction deg2Rad(deg: number): number {\n  return (deg * Math.PI) / 180;\n}\n\nfunction rad2Deg(rad: number): number {\n  return (rad * 180) / Math.PI;\n}\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.min(max, Math.max(value, min));\n}\n\n/**\n *\n * @param angleDeg - top is 0, increases cw. Should be converted to right 0, increases ccw.\n * @returns\n */\nfunction getUnitCircleCords(\n  angleDeg: number,\n  counterClockwise = false\n): [number, number] {\n  const unitAngle = deg2Rad(-(angleDeg - 90));\n  const x = counterClockwise ? -Math.cos(unitAngle) : Math.cos(unitAngle);\n  return [x, Math.sin(unitAngle)];\n}\n\nexport default class Gyro extends LitElement {\n  @property({ type: Number }) value = 0;\n  @property({ type: Boolean, attribute: 'hide-label' }) hideLabel = false;\n  @property({ type: Number }) precision = 2;\n  @property({ type: Boolean, attribute: 'counter-clockwise' })\n  counterClockwise = false;\n  @property({ type: Boolean, attribute: 'from-radians' }) fromRadians = false;\n\n  @query('svg') _svg!: SVGSVGElement;\n  @query('.dial') _dial!: SVGLineElement;\n  @query('.gyro') _gyro!: SVGGElement;\n  @query('.gyro-edge') _gyroEdge!: SVGCircleElement;\n  @query('.minor-ticks') _minorTicks!: SVGGElement;\n  @query('.major-ticks') _majorTicks!: SVGGElement;\n  @query('.labels') _labels!: SVGGElement;\n\n  static styles = css`\n    :host {\n      font-family: sans-serif;\n      display: inline-flex;\n      flex-direction: column;\n      align-items: center;\n      position: relative;\n      width: 300px;\n      height: auto;\n    }\n\n    svg {\n      width: 100%;\n    }\n\n    label {\n      color: var(--frc-gyro-color, #000);\n      text-align: center;\n      display: block;\n      font-size: 16px;\n    }\n\n    .dial-circle {\n      fill: var(--frc-gyro-dial-color, blue);\n    }\n\n    .dial {\n      stroke: var(--frc-gyro-dial-color, blue);\n      stroke-width: 3;\n    }\n  `;\n\n  setLabels(): void {\n    const chartRadius = this.getGyroRadius();\n    d3.select(this._labels)\n      .selectAll('text')\n      .data([0, 45, 90, 135, 180, -135, -90, -45])\n      .join((enter) =>\n        enter\n          .append('text')\n          .attr('text-anchor', 'middle')\n          .attr('alignment-baseline', 'middle')\n          .attr('font-size', 15)\n          .attr('fill', 'var(--frc-gyro-color, #000)')\n          .text((angle) => `${angle}Â°`)\n      )\n      .attr(\n        'x',\n        (angle) =>\n          getUnitCircleCords(angle, this.counterClockwise)[0] *\n          (chartRadius + 30)\n      )\n      .attr(\n        'y',\n        (angle) =>\n          -getUnitCircleCords(angle, this.counterClockwise)[1] *\n          (chartRadius + 30)\n      );\n  }\n\n  setDialAngle(): void {\n    const chartRadius = this.getGyroRadius();\n    const angle = this.fromRadians ? rad2Deg(this.value) : this.value;\n    d3.select(this._dial)\n      .attr(\n        'x2',\n        getUnitCircleCords(angle, this.counterClockwise)[0] * (chartRadius - 7)\n      )\n      .attr(\n        'y2',\n        -getUnitCircleCords(angle, this.counterClockwise)[1] * (chartRadius - 7)\n      );\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  addTicks(\n    parent: SVGElement,\n    tickLength: number,\n    step: number,\n    strokeWidth: number\n  ): void {\n    const chartRadius = this.getGyroRadius();\n    d3.select(parent)\n      .selectAll('line')\n      .data(d3.range(0, 360, step))\n      .join((enter) =>\n        enter\n          .append('line')\n          .attr('stroke', 'var(--frc-gyro-color, #000)')\n          .attr('stroke-width', strokeWidth)\n      )\n      .attr('x1', (angle) => getUnitCircleCords(angle)[0] * chartRadius)\n      .attr('y1', (angle) => -getUnitCircleCords(angle)[1] * chartRadius)\n      .attr(\n        'x2',\n        (angle) => getUnitCircleCords(angle)[0] * (chartRadius + tickLength)\n      )\n      .attr(\n        'y2',\n        (angle) => -getUnitCircleCords(angle)[1] * (chartRadius + tickLength)\n      );\n  }\n\n  firstUpdated(): void {\n    const resizeObserver = new ResizeObserver(() => {\n      this.resized();\n    });\n    resizeObserver.observe(this);\n    this.resized();\n  }\n\n  resized(): void {\n    const size = this.getSize();\n    d3.select(this._svg).attr('width', size).attr('height', size);\n\n    d3.select(this._gyro).attr(\n      'transform',\n      `translate(${size / 2},${size / 2})`\n    );\n\n    const chartRadius = this.getGyroRadius();\n\n    d3.select(this._gyroEdge).attr('r', chartRadius);\n\n    this.addTicks(this._minorTicks, 5, 5, 1);\n    this.addTicks(this._majorTicks, 10, 45, 2);\n    this.setLabels();\n    this.setDialAngle();\n  }\n\n  getSize(): number {\n    const { width } = this.getBoundingClientRect();\n    return width;\n  }\n\n  getGyroRadius(): number {\n    return this.getSize() / 2 - 53;\n  }\n\n  updated(changedProps: Map<string, unknown>): void {\n    if (\n      changedProps.has('value') ||\n      changedProps.has('fromRadians') ||\n      changedProps.has('counterClockwise')\n    ) {\n      this.setDialAngle();\n    }\n\n    if (changedProps.has('counterClockwise')) {\n      this.setLabels();\n    }\n  }\n\n  render(): TemplateResult {\n    const angle = this.fromRadians ? rad2Deg(this.value) : this.value;\n    const label = `${angle.toFixed(clamp(this.precision, 0, 100))}`;\n    return svg`\n        <div>\n        <svg>\n          <g class=\"gyro\">\n            <circle class=\"gyro-edge\" stroke-width=\"2\" stroke=\"var(--frc-gyro-color, #000)\" style=\"fill: none\"></circle>\n            <g class=\"minor-ticks\"></g>\n            <g class=\"major-ticks\"></g>\n            <g class=\"labels\"></g>\n            <circle class=\"dial-circle\" r=\"9\"></circle>\n            <line class=\"dial\" x1=\"0\" x2=\"0\"></line>\n          </g>\n        </svg>\n        ${!this.hideLabel ? html`<label>${label}&deg</label> ` : null}\n        </div>\n    `;\n  }\n}\n\nif (!customElements.get('frc-gyro')) {\n  customElements.define('frc-gyro', Gyro);\n}\n"],"names":["range","start","stop","step","n","i","deg2Rad","deg","rad2Deg","rad","clamp","value","min","max","getUnitCircleCords","angleDeg","counterClockwise","unitAngle","Gyro","LitElement","chartRadius","d3.select","enter","angle","parent","tickLength","strokeWidth","d3.range","size","width","changedProps","label","svg","html","css","__decorateClass","property","query"],"mappings":"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","x_google_ignoreList":[0]}